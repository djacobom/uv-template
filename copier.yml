# Prevents internal template files from being copied
_exclude:
  - "extensions"
  - "copier.yml"
  - ".git"
  - "README.md"   # Project own README

# Loads custom Jinja2 extensions
_jinja_extensions:
  - copier_templates_extensions.TemplateExtensionLoader
  - extensions/get_data.py:GCloudExtension

# User prompts
# 1. User picks the project first
gcp_project_id:
  type: str
  help: ¿Cuál es el ID del proyecto de GCP que quieres usar?
  choices: "{{ gcloud_projects }}"

# 2. Copier uses that ID to fetch the relevant Service Accounts
service_account_email:
  type: str
  help: Selecciona la cuenta de servicio a utilizar
  choices: "{{ fetch_sas(gcp_project_id) }}"

# 3. Docker image name
image_name:
  type: str
  help: Nombre de la imagen Docker a usar

# 4. Artifact Registry selection
# 4.1. THE PICKER: This is the only prompt the user sees for the repo
_artifact_selection:
  type: json
  help: Seleccione el repositorio de Artifact Registry
  choices: "{{ fetch_artifacts(gcp_project_id) }}"

# 4.2. AUTO-EXTRACT & Hide to the user
repo_name:
  type: str
  help: Nombre del repositorio de Artifact Registry
  default: "{{ _artifact_selection.name }}"
  when: false
ar_region:
  type: str
  help: Región de Artifact Registry
  default: "{{ _artifact_selection.region }}"
  when: false

# 5. Cloud Run region
c_run_region:
  type: str
  help: Región de Cloud Run a utilizar
  choices:
    "northamerica-south1 (Mexico)": "northamerica-south1"
    "us-central1 (Iowa) Low CO2": "us-central1"
    "us-east1 (South Carolina)": "us-east1"
    "us-east4 (Northern Virginia)": "us-east4"
    "us-east5 (Columbus)": "us-east5"
    "us-south1 (Dallas) Low CO2": "us-south1"
    "us-west1 (Oregon) Low CO2": "us-west1"
  default: "us-east4"

# 6. Cloud Run service name
c_run_name:
  type: str
  help: Nombre del servicio de Cloud Run

# 7. User picks the desired filename for the environment
env_filename:
  type: str
  help: ¿Cómo llamamos a tu nuevo entorno?
  default: "dev"

